 <HTML>
	<head>
        <title>Pi3 Wifi Setup</title>
			<link rel="stylesheet" type="text/css" href="css/screen.css">
            <!-- Latest compiled and minified CSS -->
            <link rel="stylesheet" href="/css/bootstrap.min.css">
            <!-- jQuery library -->
            <script src="/js/jquery.min.js"></script>
            <!-- Latest compiled JavaScript -->
            <script src="/js/bootstrap.min.js"></script>
            <meta name="viewport" content="width=device-width, initial-scale=1">
        </head>
		<script src="/js/bootstrap.min.js"></script>
        <script type="text/javascript">
		var selectedSSID = "no network";
            function getWifiList(){
                //clear the slect list
				var selectList = document.getElementById('selectEssid');
				for (var i=document.getElementById('selectEssid').options.length; i-->0;)
				    document.getElementById('selectEssid').options[i] = null;
                
				// get networks json
				var url = "/wifi_list";
                $.getJSON(url, function(data){

                    var option = document.createElement("option");
                    option.value = "no network";
                    option.text = "Please select a network";
                    selectList.appendChild(option);
                    for (var i = 0; i < data.length; i++) {
                        if(data[i] != null){
                            var option = document.createElement("option");
							if(data[i].ssid === selectedSSID){
								option.selected = 'selected';
							}
                            option.value = data[i].ssid;
                            option.text = data[i].ssid + " " + data[i].quality;
                            selectList.appendChild(option);
                        }
                    }
                });
            }
			//store selected network
			function selectEssidChanged(value){
				selectedSSID = value;
			}
		</script>
        <body onload="javascript:getWifiList();setInterval( getWifiList, 10000 );">
		    <table>
					<tr>
						<td><img src='/images/sprite.png'/></td>
					</tr>
				<form action='/connect' method='post'>
					<tr>
						<th class="panel-heading">Wifi:</th>
                    </tr>
                    <tr>
                        <td>
						
							<select class="form-control" name='essid' id="selectEssid" onChange="selectEssidChanged(this.value)">
							</select>
						</td>
                    </tr>
                    <tr>
						<th class="panel-heading">Passphrase:</th>
                    </tr>
                    <tr>
                        <td>
							<input class="form-control" type='password' name='passphrase'/>
						</td>
                    </tr>
					<tr>
						<td>
							<br/>
							<input class="btn btn-success" type='submit' value='connect'/>
							<br/>
							<br/>
							
						</td>
					</tr>
				</form>

			</table>
			
	</body>
</html>
